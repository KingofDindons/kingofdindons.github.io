{"version":3,"sources":["./src/app/capture/capture-routing.module.ts","./src/app/capture/capture.module.ts","./src/app/capture/capture.page.ts","./src/app/capture/capture.page.scss","./src/app/capture/capture.page.html"],"names":[],"mappings":"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","file":"src_app_capture_capture_module_ts.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { CapturePage } from './capture.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: CapturePage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class CapturePageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { CapturePageRoutingModule } from './capture-routing.module';\r\n\r\nimport { CapturePage } from './capture.page';\r\n\r\nimport { CustomComponentsModule } from '@app/custom-components/custom-components.module';\r\n\r\n\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    CapturePageRoutingModule,\r\n    CustomComponentsModule\r\n  ],\r\n  declarations: [CapturePage]\r\n})\r\nexport class CapturePageModule {}\r\n","import { Component, Input, OnInit } from '@angular/core';\r\nimport { StoreService } from \"../store/store.service\";\r\nimport { AnimalService } from '@app/services/animal.service';\r\nimport { Animal } from 'src/models/animal.model';\r\nimport { AnimalUser } from 'src/models/animaluser.model';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { environment } from 'src/environments/environment';\r\nimport { AnimalUserService } from '@app/services/animaluser.service';\r\n\r\n\r\n\r\n@Component({\r\n  selector: 'app-capture',\r\n  templateUrl: './capture.page.html',\r\n  styleUrls: ['./capture.page.scss'],\r\n})\r\nexport class CapturePage implements OnInit {\r\n\r\n  pictureURL: string;\r\n  animals: Animal[];\r\n  retrieveAnimal: Omit<AnimalUser, 'deserialize'>;\r\n  animalName: string;\r\n  animalType: string;\r\n  animalsUser: AnimalUser[];\r\n\r\n  constructor(private http: HttpClient, private store: StoreService, private animalService: AnimalService, private animalUserService: AnimalUserService) {\r\n\r\n    this.pictureURL = this.store.picture\r\n  }\r\n\r\n  ngOnInit() {\r\n\r\n    this.animalService.getAllAnimals().subscribe(animals => {\r\n      this.animals = animals;\r\n\r\n      this.animalUserService.getAllAnimals(this.store.username).subscribe(animal => {\r\n        this.animalsUser = animal;\r\n      });\r\n    })\r\n  }\r\n\r\n  private returnAnimalData(animal: Animal) : Omit<AnimalUser, 'deserialize'> {\r\n    let animalData = {\r\n      id: 1,\r\n      type: this.animalType,\r\n      name: this.animalName,\r\n      hp: this.getRandomStat(animal.hp_default, animal.hp_variation),\r\n      attack: this.getRandomStat(animal.attack_default, animal.attack_variation),\r\n      level: this.getRandomStat(animal.level_default, animal.level_variation),\r\n      picture: this.pictureURL,\r\n    };\r\n    return animalData;\r\n  }\r\n\r\n  private getRandomStat(default_stat : number, variation : number) : number {\r\n    return Math.floor(Math.random() * ((default_stat + variation) - (default_stat - variation)) + (default_stat - variation));\r\n  }\r\n\r\n  onSubmit() {\r\n    let animalModel = this.animals.filter(animal => animal.type == this.animalType)[0];\r\n    this.retrieveAnimal = this.returnAnimalData(animalModel);\r\n\r\n    if (this.animalsUser.length === 0) {\r\n      this.retrieveAnimal.id = 1\r\n    } else {\r\n      if (this.animalsUser[this.animalsUser.length - 1].id >= 0) {\r\n        this.retrieveAnimal.id = (this.animalsUser[this.animalsUser.length - 1].id) + 1\r\n      } else {\r\n        this.retrieveAnimal.id = 1\r\n      }\r\n      \r\n    }\r\n\r\n    console.log(JSON.stringify(this.retrieveAnimal));\r\n\r\n    let test = this.http.post(`${environment.apiUrl}users/${this.store.username}/animals`, this.retrieveAnimal)\r\n\r\n    test.subscribe({\r\n      next: () => {\r\n        console.log(\"yes\")\r\n      },\r\n      error: (err) => {\r\n        console.warn(`Register failed: ${err.message}`);\r\n      },\r\n\r\n    });\r\n\r\n  }\r\n}\r\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJjYXB0dXJlLnBhZ2Uuc2NzcyJ9 */\";","export default \"<ion-content [fullscreen]=\\\"true\\\" class=\\\"background-image\\\" padding>\\r\\n\\r\\n  <app-page-title title=\\\"Enregistrer votre Animal\\\" backUrl=\\\"/start\\\"></app-page-title>\\r\\n\\r\\n  <form #loginForm=\\\"ngForm\\\" (submit)=\\\"onSubmit(loginForm)\\\">\\r\\n    <ion-list>\\r\\n\\r\\n      <img *ngIf=\\\"pictureURL\\\" [src]=\\\"pictureURL\\\" />\\r\\n      <!-- Animal input -->\\r\\n      <ion-item>\\r\\n        <ion-label position=\\\"floating\\\">Nom de l'animal</ion-label>\\r\\n        <ion-input [(ngModel)]=\\\"animalName\\\" inputmode=\\\"text\\\" required=\\\"true\\\" name=\\\"animalName\\\"></ion-input>\\r\\n      </ion-item>\\r\\n\\r\\n\\r\\n\\r\\n\\r\\n      <ion-item>\\r\\n        <ion-label position=\\\"floating\\\">Type de votre animal</ion-label>\\r\\n        <ion-select [(ngModel)]=\\\"animalType\\\" required=\\\"true\\\" name=\\\"animalType\\\" okText=\\\"choisir\\\" cancelText=\\\"retour\\\">\\r\\n          <ion-select-option *ngFor=\\\"let animal of animals\\\">{{animal.type}}</ion-select-option>\\r\\n        </ion-select>\\r\\n      </ion-item>\\r\\n\\r\\n    </ion-list>\\r\\n    <div class=\\\"ion-padding\\\">\\r\\n      <ion-button type=\\\"submit\\\" expand=\\\"block\\\" routerLink=\\\"/profile\\\">Valider</ion-button>\\r\\n      <ion-text color=\\\"danger\\\" *ngIf=\\\"loginError\\\"> C'est pas possible</ion-text>\\r\\n\\r\\n    </div>\\r\\n  </form>\\r\\n</ion-content>\";"],"sourceRoot":"webpack:///"}